document.addEventListener("DOMContentLoaded",function(){const t=document.querySelectorAll(".snippet-ref"),n=document.querySelectorAll(".snippet"),e=document.querySelector(".snippets-container");let s=null;function i(){if(window.innerWidth<800)return;t.forEach((t,n)=>{const s=document.getElementById("snippet-"+n);if(s){const n=t.getBoundingClientRect(),o=e.getBoundingClientRect(),i=e.scrollTop,a=n.top-o.top+i-10;s.style.top=a+"px"}})}function o(){if(window.innerWidth<800)return;const s=e.getBoundingClientRect(),o=s.height,t=e.scrollTop;n.forEach((e)=>{const s=parseInt(e.style.top)||0,i=e.offsetHeight,a=s+i>t-100&&s<t+o+100;a?e.classList.add("visible"):e.classList.remove("visible")})}if(t.forEach((t,o)=>{t.addEventListener("click",function(t){t.preventDefault();const i=document.getElementById("snippet-"+o);if(i&&window.innerWidth>=800){n.forEach(e=>e.classList.remove("active")),i.classList.add("active","visible"),s=i;const t=parseInt(i.style.top)||0,o=e.offsetHeight,a=i.offsetHeight,r=t-o/2+a/2;e.scrollTo({top:r,behavior:"smooth"})}})}),window.innerWidth>=800){const o={rootMargin:"-30% 0px -60% 0px",threshold:[0,1]},i=new IntersectionObserver(t=>{t.forEach(t=>{if(t.isIntersecting){const i=t.target.getAttribute("data-snippet"),o=document.getElementById("snippet-"+i);if(o&&!s){n.forEach(e=>e.classList.remove("active")),o.classList.add("active");const t=parseInt(o.style.top)||0,s=e.offsetHeight,i=e.scrollTop,a=o.offsetHeight;if(t<i||t+a>i+s){const n=t-s/2+a/2;e.scrollTo({top:n,behavior:"smooth"})}}}})},o);t.forEach(e=>i.observe(e))}document.addEventListener("click",function(e){!e.target.closest(".snippet-ref")&&!e.target.closest(".snippet")&&(s=null)}),window.innerWidth>=800&&(i(),o(),e.addEventListener("scroll",o),window.addEventListener("resize",()=>{i(),o()}))})