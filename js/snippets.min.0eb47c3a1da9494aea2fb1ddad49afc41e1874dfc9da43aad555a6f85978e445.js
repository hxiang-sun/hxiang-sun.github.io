document.addEventListener("DOMContentLoaded",function(){const e=document.querySelectorAll(".snippet-ref"),i=document.querySelectorAll(".snippet"),a=document.querySelector(".snippets-container");let n=null,s=!1;const r=[],c=[];function o(){e.forEach((e,t)=>{const n=document.getElementById("snippet-"+t);n&&(r[t]=e.offsetTop,c[t]=n)})}function t(){if(window.innerWidth<800||!a)return;const t=window.pageYOffset,n=a.getBoundingClientRect(),o=n.top+t;e.forEach((e,n)=>{const s=c[n];if(s){const e=r[n],i=e-o;s.style.transform=`translateY(${i}px)`;const a=t,c=t+window.innerHeight,l=e>a-200&&e<c+200;l?s.classList.add("visible"):s.classList.remove("visible")}}),s=!1}function l(){s||(window.requestAnimationFrame(t),s=!0)}if(e.forEach((e,t)=>{e.addEventListener("click",function(e){e.preventDefault();const s=document.getElementById("snippet-"+t);s&&window.innerWidth>=800&&(i.forEach(e=>e.classList.remove("active")),s.classList.add("active","visible"),n=s)})}),window.innerWidth>=800){const t={rootMargin:"-30% 0px -60% 0px",threshold:[0,1]},s=new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting){const s=e.target.getAttribute("data-snippet"),t=document.getElementById("snippet-"+s);t&&!n&&(i.forEach(e=>e.classList.remove("active")),t.classList.add("active"))}})},t);e.forEach(e=>s.observe(e))}document.addEventListener("click",function(e){!e.target.closest(".snippet-ref")&&!e.target.closest(".snippet")&&(n=null)}),window.innerWidth>=800&&(o(),t(),window.addEventListener("scroll",l,{passive:!0}),window.addEventListener("resize",()=>{window.innerWidth>=800&&(o(),t())}),window.addEventListener("load",()=>{o(),t()}))})